import{j as e,r}from"./react-DHqCc_uR.js";import{c as nt}from"./react-dom-CuuQ5-yA.js";import{O as de,u as it,N as lt,a as me,b as ue,B as ct,R as dt,c as oe}from"./react-router-C1rnM6mN.js";import{T as he,I as mt,S as xe,a as fe,P as ut,C as pe,V as ht,L as ge,b as be,c as xt,d as ft,e as ve,R as pt,f as gt,g as ye,h as je,i as Ne,j as Se,k as bt,O as we,l as vt,m as Ce,n as yt,o as ke,D as Re,p as jt,q as Nt,r as Le}from"./@radix-ui-DlSYMwF_.js";import{c as St}from"./clsx-B-dksMZM.js";import{t as wt}from"./tailwind-merge-D696Ktp4.js";import{C as De,a as Ct,b as kt,c as Rt,U as Y,X as Lt,L as Dt,d as Pt,S as Tt,e as It,F as At,f as Ft,D as Et,g as Mt,P as Ot}from"./lucide-react-BebdMXD8.js";import{c as U}from"./class-variance-authority-Dp3B9jqt.js";import{j as ne}from"./jsqr-fyFDz0PP.js";import{V as C,O as $t}from"./react-hot-toast-B7KtrtSH.js";import{a as ie}from"./axios-C88pvD_q.js";import{u as Ht,F as Bt,C as Ut,b as Pe}from"./react-hook-form-Uz6ZXrja.js";import{z as F}from"./zod-mSkvzYyn.js";import{t as Te}from"./@hookform-B-JUM-j1.js";import{r as zt,u as H,w as Vt}from"./xlsx-D8wqrsip.js";import"./cookie-Ddo6p1Qn.js";import"./scheduler-DYLXRpC5.js";import"./@floating-ui-DEJPq-br.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-BlIxM1M_.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-4iB6bYdv.js";import"./react-style-singleton-CMA6-1ZH.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-etjUjgc1.js";import"./use-callback-ref-BKF_JUQ0.js";import"./goober-np-fLvOt.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();const Gt=()=>e.jsxs("main",{className:"w-full h-full",children:[e.jsx(de,{}),e.jsx("div",{className:"mt-32"})]}),Ie=({children:t})=>e.jsx("div",{className:"flex flex-col min-h-screen  items-center justify-center",children:e.jsx("div",{className:"container mx-auto max-w-5xl px-4",children:t})}),Ae=({sidebar:t,content:s})=>e.jsxs("div",{className:"flex flex-1 container mx-auto",children:[t,e.jsx("main",{className:"flex-1 ml-4 rounded-xl mt-4 ring-1 ring-secondary p-4",children:s})]}),E=({children:t,variant:s="default",className:a=""})=>{const o={default:"text-base",title:"font-bold text-xl",subtitle:"text-sm text-gray-500",label:"font-medium text-sm text-gray-500"};return e.jsx("span",{className:`${o[s]} ${a}`,children:t})},_t=()=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{width:40,height:40,src:"/images/logo.png",alt:""}),e.jsx(E,{variant:"title",children:"Exam Results"})]});function c(...t){return wt(St(t))}const Fe=pt,Ee=gt,W=r.forwardRef(({className:t,children:s,...a},o)=>e.jsxs(he,{ref:o,className:c("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-full border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(mt,{asChild:!0,children:e.jsx(De,{className:"h-4 w-4 opacity-50"})})]}));W.displayName=he.displayName;const Me=r.forwardRef(({className:t,...s},a)=>e.jsx(xe,{ref:a,className:c("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Ct,{className:"h-4 w-4"})}));Me.displayName=xe.displayName;const Oe=r.forwardRef(({className:t,...s},a)=>e.jsx(fe,{ref:a,className:c("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(De,{className:"h-4 w-4"})}));Oe.displayName=fe.displayName;const X=r.forwardRef(({className:t,children:s,position:a="popper",...o},n)=>e.jsx(ut,{children:e.jsxs(pe,{ref:n,className:c("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...o,children:[e.jsx(Me,{}),e.jsx(ht,{className:c("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Oe,{})]})}));X.displayName=pe.displayName;const qt=r.forwardRef(({className:t,...s},a)=>e.jsx(ge,{ref:a,className:c("px-2 py-1.5 text-sm font-semibold",t),...s}));qt.displayName=ge.displayName;const A=r.forwardRef(({className:t,children:s,...a},o)=>e.jsxs(be,{ref:o,className:c("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...a,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(xt,{children:e.jsx(kt,{className:"h-4 w-4"})})}),e.jsx(ft,{children:s})]}));A.displayName=be.displayName;const Jt=r.forwardRef(({className:t,...s},a)=>e.jsx(ve,{ref:a,className:c("-mx-1 my-1 h-px bg-muted",t),...s}));Jt.displayName=ve.displayName;const Yt=({selectedYear:t,setSelectedYear:s})=>e.jsxs(Fe,{value:t,onValueChange:s,children:[e.jsx(W,{className:"w-36",children:e.jsx(Ee,{placeholder:"Year"})}),e.jsxs(X,{children:[e.jsx(A,{value:"2025",children:"2025"}),e.jsx(A,{value:"2024",children:"2024"}),e.jsx(A,{value:"2023",children:"2023"}),e.jsx(A,{value:"2022",children:"2022"}),e.jsx(A,{value:"2021",children:"2021"})]})]}),M=({icon:t,size:s=4,className:a=""})=>e.jsx(t,{className:`h-${s} w-${s} ${a}`}),Qt=U("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground  hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground  hover:bg-destructive/90",outline:"border border-input bg-background  hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground  hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),D=r.forwardRef(({className:t,variant:s,size:a,asChild:o=!1,...n},i)=>{const l=o?ye:"button";return e.jsx(l,{className:c(Qt({variant:s,size:a,className:t})),ref:i,...n})});D.displayName="Button";const z=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("rounded-xl border bg-card text-card-foreground ",t),...s}));z.displayName="Card";const V=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("flex flex-col space-y-1.5 p-6",t),...s}));V.displayName="CardHeader";const G=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("font-semibold leading-none tracking-tight",t),...s}));G.displayName="CardTitle";const Kt=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("text-sm text-muted-foreground",t),...s}));Kt.displayName="CardDescription";const _=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("p-6 pt-0",t),...s}));_.displayName="CardContent";const $e=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("flex items-center p-6 pt-0",t),...s}));$e.displayName="CardFooter";const He=bt,Z=r.forwardRef(({className:t,...s},a)=>e.jsx(je,{ref:a,className:c("inline-flex h-10 gap-4 items-center justify-center rounded-md  p-1 text-muted-foreground",t),...s}));Z.displayName=je.displayName;const $=r.forwardRef(({className:t,...s},a)=>e.jsx(Ne,{ref:a,className:c("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-black data-[state=active]:text-white",t),...s}));$.displayName=Ne.displayName;const Q=r.forwardRef(({className:t,...s},a)=>e.jsx(Se,{ref:a,className:c("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));Q.displayName=Se.displayName;const Wt=({onScanSuccess:t})=>{const[s,a]=r.useState("camera"),[o,n]=r.useState(!1),[i,l]=r.useState(null),u=r.useRef(null),b=r.useRef(null),v=r.useRef(null),k=async()=>{try{l(null);const m=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});u.current&&(u.current.srcObject=m,v.current=m,n(!0),requestAnimationFrame(p))}catch(m){l("Camera access denied or not available."),console.error("Error accessing camera:",m)}},g=()=>{v.current&&(v.current.getTracks().forEach(m=>m.stop()),v.current=null),n(!1)},p=()=>{const m=u.current,h=b.current,y=h==null?void 0:h.getContext("2d");if(y&&(m==null?void 0:m.readyState)===(m==null?void 0:m.HAVE_ENOUGH_DATA)){h.height=m==null?void 0:m.videoHeight,h.width=m==null?void 0:m.videoWidth,y==null||y.drawImage(m,0,0,h==null?void 0:h.width,h==null?void 0:h.height);const j=y.getImageData(0,0,h==null?void 0:h.width,h==null?void 0:h.height),P=ne(j.data,j.width,j.height,{inversionAttempts:"dontInvert"});if(P)try{const d=JSON.parse(P.data);if(R(d)){g(),t(d);return}}catch(d){C.error(d instanceof Error?d.message:String(d))}requestAnimationFrame(p)}else requestAnimationFrame(p)},S=m=>{var j;const h=(j=m.target.files)==null?void 0:j[0];if(!h)return;l(null);const y=new FileReader;y.onload=P=>{var w;const d=new Image;d.onload=()=>{const f=document.createElement("canvas"),N=f.getContext("2d");if(!N){l("Could not process image");return}f.width=d.width,f.height=d.height,N.drawImage(d,0,0);const x=N.getImageData(0,0,f.width,f.height),I=ne(x.data,x.width,x.height,{inversionAttempts:"dontInvert"});if(I)try{const L=JSON.parse(I.data);if(R(L)){t(L);return}l("Invalid QR code format")}catch{l("Invalid QR code content")}else l("No QR code found in image")},d.src=(w=P.target)==null?void 0:w.result},y.readAsDataURL(h)},R=m=>typeof m=="object"&&typeof m.token=="string"&&typeof m.number=="string"&&typeof m.isExpired=="boolean";return r.useEffect(()=>(s==="camera"?k():g(),()=>{g()}),[s]),e.jsxs(z,{className:"w-full max-w-md mx-auto",children:[e.jsx(V,{children:e.jsx(G,{children:"Scan QR Code"})}),e.jsxs(He,{value:s,onValueChange:a,children:[e.jsxs(Z,{className:"grid w-full grid-cols-2",children:[e.jsxs($,{value:"camera",children:[e.jsx(Rt,{className:"mr-2 h-4 w-4"})," Camera"]}),e.jsxs($,{value:"upload",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"})," Upload"]})]}),e.jsxs(_,{className:"p-4",children:[e.jsx(Q,{value:"camera",className:"mt-0",children:e.jsxs("div",{className:"relative aspect-video bg-muted rounded overflow-hidden",children:[e.jsx("video",{ref:u,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0}),e.jsx("canvas",{ref:b,className:"hidden"}),o&&e.jsx("div",{className:"absolute inset-0 border-2 border-primary pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"h-48 w-48 border-2 border-white border-dashed rounded-lg"})})})]})}),e.jsx(Q,{value:"upload",className:"mt-0",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-muted-foreground rounded-lg min-h-40",children:[e.jsx(Y,{className:"h-10 w-10 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-center text-sm text-muted-foreground mb-2",children:"Upload an image containing a QR code"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",id:"qr-file-input",onChange:S}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>{var m;return(m=document.getElementById("qr-file-input"))==null?void 0:m.click()},children:"Select File"})]})})]})]}),i&&e.jsx($e,{className:"pt-0",children:e.jsx("p",{className:"text-sm text-destructive",children:i})})]})},Be=jt,Xt=Nt,Zt=vt,Ue=r.forwardRef(({className:t,...s},a)=>e.jsx(we,{ref:a,className:c("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));Ue.displayName=we.displayName;const ee=r.forwardRef(({className:t,children:s,...a},o)=>e.jsxs(Zt,{children:[e.jsx(Ue,{}),e.jsxs(Ce,{ref:o,className:c("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a,children:[s,e.jsxs(yt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Lt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ee.displayName=Ce.displayName;const ze=({className:t,...s})=>e.jsx("div",{className:c("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});ze.displayName="DialogHeader";const Ve=({className:t,...s})=>e.jsx("div",{className:c("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Ve.displayName="DialogFooter";const te=r.forwardRef(({className:t,...s},a)=>e.jsx(ke,{ref:a,className:c("text-lg font-semibold leading-none tracking-tight",t),...s}));te.displayName=ke.displayName;const Ge=r.forwardRef(({className:t,...s},a)=>e.jsx(Re,{ref:a,className:c("text-sm text-muted-foreground",t),...s}));Ge.displayName=Re.displayName;const _e=r.createContext(null),es=()=>{const t=sessionStorage.getItem("userData");if(!t)return null;try{return JSON.parse(t)}catch{return null}},ts=({children:t})=>{const[s,a]=r.useState(!1),[o,n]=r.useState(null),[i,l]=r.useState(!0),u=it();r.useEffect(()=>{b()},[]);const b=()=>{const p=es();p&&(n(p),a(!0)),l(!1)},g={isAuthenticated:s,userData:o,login:(p,S)=>{const R={token:p,number:S};sessionStorage.setItem("userData",JSON.stringify(R)),n(R),a(!0),C.success("Logged in successfully"),u("/portal")},logout:async()=>{sessionStorage.removeItem("userData"),n(null),a(!1),C.success("Logged out successfully"),u("/")},loading:i};return e.jsx(_e.Provider,{value:g,children:!i&&t})},se=()=>{const t=r.useContext(_e);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},ss=()=>{const[t,s]=r.useState(!1),{login:a,logout:o,isAuthenticated:n}=se(),i=l=>{if(l.isExpired){alert("This QR code has expired. Please use a valid code.");return}a(l.token,l.number),s(!1)};return n?e.jsxs(D,{variant:"outline",size:"sm",className:"flex rounded-full items-center bg-red-50 hover:bg-red-100 text-red-600 border-red-200",onClick:o,children:[e.jsx(M,{icon:Dt,className:"mr-2"}),"Logout"]}):e.jsxs(e.Fragment,{children:[e.jsxs(D,{variant:"outline",size:"sm",className:"flex rounded-full items-center",onClick:()=>s(!0),children:[e.jsx(M,{icon:Pt,className:"mr-2"}),"Login"]}),e.jsx(Be,{open:t,onOpenChange:s,children:e.jsxs(ee,{children:[e.jsx(te,{children:"Login with QR Code"}),e.jsx(Wt,{onScanSuccess:i})]})})]})},qe=({selectedYear:t,setSelectedYear:s})=>e.jsx("header",{className:"bg-gray-150 border-b border-b-secondary shadow-none",children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsx(_t,{}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Yt,{selectedYear:t,setSelectedYear:s}),e.jsx(ss,{})]})]})}),ae=r.forwardRef(({className:t,type:s,...a},o)=>e.jsx("input",{type:s,className:c("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base  transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:o,...a}));ae.displayName="Input";const re=({placeholder:t,value:s,onChange:a,onSearch:o=null})=>e.jsxs("div",{className:"flex w-full",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(M,{icon:Tt,className:"absolute left-2 top-2.5 text-gray-500"}),e.jsx(ae,{placeholder:t,className:"pl-8 rounded-full",value:s,onChange:n=>a(n.target.value)})]}),o&&e.jsx("div",{className:"ml-2",children:e.jsx(D,{className:"text-black",onClick:o,children:"Search"})})]}),as=()=>{const[t,s]=r.useState(""),o=[{id:"distributed",name:"Distributed Students List",path:"/portal/distributed"},{id:"locate",name:"Locate Students",path:"/portal/locate"}].filter(n=>n.name.toLowerCase().includes(t.toLowerCase()));return e.jsxs("aside",{className:"w-64 mt-4 rounded-xl bg-white p-4 ring-1 ring-secondary",children:[e.jsx("div",{className:"mb-6",children:e.jsx(re,{placeholder:"Search options...",value:t,onChange:s})}),e.jsxs("div",{className:"mt-6",children:[e.jsx(E,{variant:"label",className:"mb-2 block",children:"Admin Options"}),e.jsx("div",{className:"space-y-1",children:o.map(n=>e.jsx(lt,{to:n.path,className:({isActive:i})=>`block p-2 rounded-md transition-colors ${i?"bg-primary text-white":"text-gray-700 hover:bg-gray-100"}`,children:n.name},n.id))})]})]})},rs=()=>{const[t,s]=r.useState("2024");return e.jsxs(Ie,{children:[e.jsx(qe,{selectedYear:t,setSelectedYear:s}),e.jsx(Ae,{sidebar:e.jsx(as,{}),content:e.jsx(de,{})})]})},os=({selectedLevel:t,setSelectedLevel:s})=>e.jsx("div",{className:"py-1 border-b border-secondary",children:e.jsx(He,{defaultValue:t,className:"w-full",children:e.jsxs(Z,{className:"w-full  justify-start",children:[e.jsx($,{className:"rounded-full font-bold  bg-secondary",value:"Primary",onClick:()=>s("Primary"),children:"Primary"}),e.jsx($,{value:"O'Level",className:"rounded-full  bg-secondary font-bold",onClick:()=>s("O'Level"),children:"O'Level"})]})})}),ns=U("relative w-full rounded-lg border border-gray-200 px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-gray-950 [&>svg~*]:pl-7 dark:border-gray-800 dark:[&>svg]:text-gray-50",{variants:{variant:{default:"bg-white text-gray-950 dark:bg-gray-950 dark:text-gray-50",destructive:"border-red-500/50 text-red-500 dark:border-red-500 [&>svg]:text-red-500 dark:border-red-900/50 dark:text-red-900 dark:dark:border-red-900 dark:[&>svg]:text-red-900"}},defaultVariants:{variant:"default"}}),Je=r.forwardRef(({className:t,variant:s,...a},o)=>e.jsx("div",{ref:o,role:"alert",className:c(ns({variant:s}),t),...a}));Je.displayName="Alert";const is=r.forwardRef(({className:t,...s},a)=>e.jsx("h5",{ref:a,className:c("mb-1 font-medium leading-none tracking-tight",t),...s}));is.displayName="AlertTitle";const Ye=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:c("text-sm [&_p]:leading-relaxed",t),...s}));Ye.displayName="AlertDescription";const ls=()=>e.jsxs(Je,{className:"mb-6",children:[e.jsx(M,{icon:It,className:"h-4 w-4"}),e.jsx(Ye,{children:"Please enter your registration number to view your examination results"})]}),cs=({registrationNumber:t,setRegistrationNumber:s,handleSearch:a})=>e.jsx("div",{className:"mb-6  p-3 rounded-md ",children:e.jsx(re,{placeholder:"Search by registration number...",value:t,onChange:s,onSearch:a})}),ds=U("inline-flex items-center rounded-md border border-gray-200 px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 dark:border-gray-800 dark:focus:ring-gray-300",{variants:{variant:{default:"border-transparent bg-gray-900 text-gray-50 shadow hover:bg-gray-900/80 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/80",secondary:"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",destructive:"border-transparent bg-red-500 text-gray-50 shadow hover:bg-red-500/80 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/80",outline:"text-gray-950 dark:text-gray-50"}},defaultVariants:{variant:"default"}});function ms({className:t,variant:s,...a}){return e.jsx("div",{className:c(ds({variant:s}),t),...a})}const Qe=()=>e.jsx("div",{className:" flex flex-col items-center justify-center",children:e.jsxs("div",{className:"relative w-10 h-10",children:[e.jsx("div",{className:"absolute w-6 h-6 border border-white rounded-full"}),e.jsx("div",{className:"absolute w-6 h-6 border border-[#854836] rounded-full border-t-transparent animate-spin"})]})}),us=({results:t,selectedYear:s,selectedLevel:a})=>e.jsxs(z,{children:[e.jsx(V,{className:"pb-3 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Examination Results"}),e.jsxs(E,{variant:"subtitle",children:[a," • ",s," • Showing ",t.length," results"]})]}),e.jsxs(ms,{variant:"outline",className:"flex rounded-full py-2 items-center",children:[e.jsx(M,{icon:At,size:4,className:"mr-1 text-black"}),s]})]})}),e.jsx(_,{className:"p-0",children:t.length>0?e.jsx("div",{className:"divide-y",children:t.map(o=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:o.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-1 space-x-2",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(M,{icon:Ft,size:4,className:"mr-1"}),o.regNumber]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:o.level})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-4",children:e.jsx("span",{className:"font-bold text-lg",children:o.score})}),e.jsx(D,{variant:"outline",size:"sm",children:"View Details"})]})]},o.id))}):e.jsx("div",{className:"p-8 text-center text-gray-500",children:e.jsx(Qe,{})})})]}),hs=({level:t,selectedLevel:s,onClick:a})=>e.jsx(D,{variant:s===t.id?"default":"ghost",className:"w-full text-black font-bold justify-start",onClick:()=>a(t.id),children:t.name}),xs=({sidebarSearch:t,setSidebarSearch:s,selectedLevel:a,setSelectedLevel:o})=>{const i=[{id:"Primary",name:"Primary Level"},{id:"O'Level",name:"O'Level"}].filter(l=>l.name.toLowerCase().includes(t.toLowerCase()));return e.jsxs("aside",{className:"w-64 mt-4 rounded-xl bg-white p-4 ring-1 ring-secondary",children:[e.jsx("div",{className:"mb-6",children:e.jsx(re,{placeholder:"Search levels...",value:t,onChange:s})}),e.jsxs("div",{className:"mt-6",children:[e.jsx(E,{variant:"label",className:"mb-2 block",children:"Choose Your Level"}),e.jsx("div",{className:"space-y-1",children:i.map(l=>e.jsx(hs,{level:l,selectedLevel:a,onClick:o},l.id))})]})]})},fs=()=>{const[t,s]=r.useState("2024"),[a,o]=r.useState("Primary"),[n,i]=r.useState(""),[l,u]=r.useState(""),[b,v]=r.useState(!1),[k,g]=r.useState([]),[p,S]=r.useState({}),R=[{id:1,name:"John Doe",level:"Primary",regNumber:"P2024001",year:"2024",score:"78%"},{id:2,name:"Jane Smith",level:"O'Level",regNumber:"O2024152",year:"2024",score:"82%"},{id:3,name:"Mike Johnson",level:"Primary",regNumber:"P2023087",year:"2023",score:"91%"},{id:4,name:"Sarah Williams",level:"O'Level",regNumber:"O2023045",year:"2023",score:"76%"},{id:5,name:"David Brown",level:"Primary",regNumber:"P2025012",year:"2025",score:"85%"}],m=()=>{if(!n)return;const h=`${n}-${t}-${a}`;if(p[h]){g(p[h]),v(!0);return}setTimeout(()=>{const y=R.filter(j=>j.regNumber.toLowerCase().includes(n.toLowerCase())&&j.year===t&&j.level===a);S(j=>({...j,[h]:y})),g(y),v(!0)},500)};return r.useEffect(()=>{g([]),v(!1)},[t,a]),e.jsxs(Ie,{children:[e.jsx(qe,{selectedYear:t,setSelectedYear:s}),e.jsx(Ae,{sidebar:e.jsx(xs,{sidebarSearch:l,setSidebarSearch:u,selectedLevel:a,setSelectedLevel:o}),content:e.jsxs(e.Fragment,{children:[e.jsx(os,{selectedLevel:a,setSelectedLevel:o}),!b&&e.jsx(ls,{}),e.jsx(cs,{registrationNumber:n,setRegistrationNumber:i,handleSearch:m}),e.jsx(us,{results:b?k:[],selectedYear:t,selectedLevel:a})]})})]})},Ke=r.forwardRef(({className:t,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:c("w-full caption-bottom text-sm",t),...s})}));Ke.displayName="Table";const We=r.forwardRef(({className:t,...s},a)=>e.jsx("thead",{ref:a,className:c("[&_tr]:border-b",t),...s}));We.displayName="TableHeader";const Xe=r.forwardRef(({className:t,...s},a)=>e.jsx("tbody",{ref:a,className:c("[&_tr:last-child]:border-0",t),...s}));Xe.displayName="TableBody";const ps=r.forwardRef(({className:t,...s},a)=>e.jsx("tfoot",{ref:a,className:c("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s}));ps.displayName="TableFooter";const K=r.forwardRef(({className:t,...s},a)=>e.jsx("tr",{ref:a,className:c("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s}));K.displayName="TableRow";const gs=r.forwardRef(({className:t,...s},a)=>e.jsx("th",{ref:a,className:c("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s}));gs.displayName="TableHead";const T=r.forwardRef(({className:t,...s},a)=>e.jsx("td",{ref:a,className:c("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s}));T.displayName="TableCell";const bs=r.forwardRef(({className:t,...s},a)=>e.jsx("caption",{ref:a,className:c("mt-4 text-sm text-muted-foreground",t),...s}));bs.displayName="TableCaption";const vs=({students:t})=>{const s=["Student Name","Registration","Total Marks","Assigned School","Allocated Combination","Reason"];return e.jsx("div",{className:"border rounded-md",children:e.jsxs(Ke,{children:[e.jsx(We,{headers:s}),e.jsx(Xe,{children:t.length===0?e.jsx(K,{children:e.jsx(T,{colSpan:6,className:"text-center h-32 text-muted-foreground",children:"No students distributed yet."})}):t.map((a,o)=>e.jsxs(K,{children:[e.jsx(T,{children:a.name}),e.jsx(T,{children:a.registrationNumber}),e.jsx(T,{children:a.totalMarks||"N/A"}),e.jsx(T,{children:a.assignedSchool||"No match"}),e.jsx(T,{children:a.allocatedCombinations&&a.allocatedCombinations.length>0?a.allocatedCombinations.map(n=>n.combinationName).join(", "):"N/A"}),e.jsx(T,{className:"max-w-md",children:a.explanation||"N/A"})]},o))})]})})},O=({children:t,isLoading:s=!1,disabled:a=!1,...o})=>e.jsx(D,{disabled:s||a,...o,children:s?"Loading...":t}),ys=U("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ze=r.forwardRef(({className:t,...s},a)=>e.jsx(Le,{ref:a,className:c(ys(),t),...s}));Ze.displayName=Le.displayName;const et=r.createContext(null),tt=Bt,js=t=>e.jsx(et.Provider,{value:{name:t.name},children:e.jsx(Ut,{...t})}),q=()=>{const t=r.useContext(et),s=r.useContext(st),{getFieldState:a,formState:o}=Ht();if(!t)throw new Error("useFormField should be used within <FormField>");const n=a(t.name,o);return{id:(s==null?void 0:s.id)??"",name:t.name,formItemId:`${(s==null?void 0:s.id)??""}-form-item`,formDescriptionId:`${(s==null?void 0:s.id)??""}-form-item-description`,formMessageId:`${(s==null?void 0:s.id)??""}-form-item-message`,...n}},st=r.createContext(null),at=r.forwardRef(({className:t,...s},a)=>{const o=r.useId();return e.jsx(st.Provider,{value:{id:o},children:e.jsx("div",{ref:a,className:c("space-y-2",t),...s})})});at.displayName="FormItem";const rt=r.forwardRef(({className:t,...s},a)=>{const{error:o,formItemId:n}=q();return e.jsx(Ze,{ref:a,className:c(o&&"text-red-500 dark:text-red-900",t),htmlFor:n,...s})});rt.displayName="FormLabel";const ot=r.forwardRef(({...t},s)=>{const{error:a,formItemId:o,formDescriptionId:n,formMessageId:i}=q();return e.jsx(ye,{ref:s,id:o,"aria-describedby":a?`${n} ${i}`:`${n}`,"aria-invalid":!!a,...t})});ot.displayName="FormControl";const Ns=r.forwardRef(({className:t,...s},a)=>{const{formDescriptionId:o}=q();return e.jsx("p",{ref:a,id:o,className:c("text-[0.8rem] text-gray-500 dark:text-gray-400",t),...s})});Ns.displayName="FormDescription";const Ss=r.forwardRef(({className:t,children:s,...a},o)=>{const{error:n,formMessageId:i}=q(),l=n?String((n==null?void 0:n.message)??""):s;return l?e.jsx("p",{ref:o,id:i,className:c("text-[0.8rem] font-medium text-red-500 dark:text-red-900",t),...a,children:l}):null});Ss.displayName="FormMessage";const B=({name:t,label:s,options:a,control:o,placeholder:n})=>e.jsx(js,{control:o,name:t,render:({field:i})=>e.jsxs(at,{children:[e.jsx(rt,{children:s}),e.jsx(ot,{children:e.jsxs(Fe,{onValueChange:i.onChange,defaultValue:i.value,children:[e.jsx(W,{children:e.jsx(Ee,{placeholder:n||`Select ${s}`})}),e.jsx(X,{children:a.map(l=>e.jsx(A,{value:l.value,children:l.label},l.value))})]})})]})}),ws=F.object({year:F.string().min(4,"Year is required"),level:F.string().min(1,"Level is required")}),Cs=({onImport:t})=>{const[s,a]=r.useState(!1),[o,n]=r.useState(null),i=Pe({resolver:Te(ws),defaultValues:{year:new Date().getFullYear().toString(),level:"secondary"}}),l=[{value:"2023",label:"2023"},{value:"2024",label:"2024"},{value:"2025",label:"2025"}],u=[{value:"primary",label:"Primary"},{value:"secondary",label:"Secondary"},{value:"university",label:"University"}],b=k=>{var S;const g=(S=k.target.files)==null?void 0:S[0];if(!g)return;const p=new FileReader;p.onload=R=>{var m;try{const h=(m=R.target)==null?void 0:m.result,y=zt(h,{type:"binary"}),j=y.SheetNames[0],P=y.Sheets[j],d=H.sheet_to_json(P);n(d)}catch(h){console.error("Error parsing Excel file:",h)}},p.readAsBinaryString(g)},v=k=>{o&&(t(o,k.year,k.level),a(!1),n(null),i.reset())};return e.jsxs(Be,{open:s,onOpenChange:a,children:[e.jsx(Xt,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"gap-2",children:[e.jsx(Y,{size:16}),"Import Data"]})}),e.jsxs(ee,{className:"sm:max-w-md",children:[e.jsxs(ze,{children:[e.jsx(te,{children:"Import Student Data"}),e.jsx(Ge,{children:"Upload an Excel file containing student information and select academic year and level."})]}),e.jsx(tt,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(v),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(B,{name:"year",label:"Academic Year",options:l,control:i.control}),e.jsx(B,{name:"level",label:"Education Level",options:u,control:i.control})]}),e.jsx(ae,{id:"file-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:b}),e.jsx(Ve,{children:e.jsx(O,{type:"submit",disabled:!o,className:"w-full",children:"Import"})})]})})]})]})},ks=({data:t,filename:s="distributed-students"})=>{const a=()=>{const o=H.json_to_sheet(t),n=H.book_new();H.book_append_sheet(n,o,"Students"),Vt(n,`${s}.xlsx`)};return e.jsxs(D,{onClick:a,variant:"outline",className:"gap-2",disabled:!t.length,children:[e.jsx(Et,{size:16}),"Export Excel"]})},Rs=F.object({year:F.string().min(4,"Year is required"),level:F.string().min(1,"Level is required")}),Ls=({onDistribute:t,onSave:s,onImport:a,onUseTestData:o,isDistributing:n,isSaving:i,distributedStudents:l})=>{const u=Pe({resolver:Te(Rs),defaultValues:{year:new Date().getFullYear().toString(),level:"secondary"}}),b=[{value:"2023",label:"2023"},{value:"2024",label:"2024"},{value:"2025",label:"2025"}],v=[{value:"primary",label:"Primary"},{value:"secondary",label:"Secondary"},{value:"university",label:"University"}],k=()=>{const{year:p,level:S}=u.getValues();t(p,S)},g=()=>{const{year:p,level:S}=u.getValues();s(p,S)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(tt,{...u,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx(B,{name:"year",label:"Academic Year",options:b,control:u.control}),e.jsx(B,{name:"level",label:"Education Level",options:v,control:u.control})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Cs,{onImport:a}),e.jsxs(O,{variant:"outline",onClick:o,className:"gap-2",children:[e.jsx(Mt,{size:16}),"Use Test Data"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(ks,{data:l}),e.jsxs(O,{variant:"secondary",onClick:k,isLoading:n,disabled:n,className:"gap-2",children:[e.jsx(Ot,{size:16}),"Distribute Students"]}),e.jsx(O,{variant:"default",onClick:g,isLoading:i,disabled:i||l.length===0,children:"Save Distribution"})]})]})]})},Ds=({title:t,onDistribute:s,onSave:a,onImport:o,onUseTestData:n,isDistributing:i,isSaving:l,distributedStudents:u})=>e.jsx("div",{className:"container mx-auto py-6 space-y-6",children:e.jsxs(z,{children:[e.jsx(V,{className:"pb-3",children:e.jsx(G,{children:t})}),e.jsxs(_,{children:[e.jsx(Ls,{onDistribute:s,onSave:a,onImport:o,onUseTestData:n,isDistributing:i,isSaving:l,distributedStudents:u}),e.jsx("div",{className:"mt-6",children:e.jsx(vs,{students:u})})]})]})}),Ps=[{id:"STU011",name:"Ethan Williams",level:"P-Level",scores:[{course:"Mathematics",marks:88},{course:"English",marks:85}],preference:["SCH006","SCH007"],registrationNumber:"REG1011",totalMarks:410,selectedCombinations:null},{id:"STU012",name:"Ava Johnson",level:"O-Level",scores:[{course:"Physics",marks:82},{course:"Chemistry",marks:87}],preference:["SCH008","SCH009"],registrationNumber:"REG1012",totalMarks:405,selectedCombinations:[{combinationName:"PCM",school:"Rwanda Science Academy"}]},{id:"STU013",name:"Mia Brown",level:"P-Level",scores:[{course:"Biology",marks:79},{course:"Geography",marks:80}],preference:["SCH006","SCH010"],registrationNumber:"REG1013",totalMarks:370,selectedCombinations:null},{id:"STU014",name:"Noah Davis",level:"O-Level",scores:[{course:"History",marks:85},{course:"Economics",marks:88}],preference:["SCH007","SCH008"],registrationNumber:"REG1014",totalMarks:410,selectedCombinations:[{combinationName:"HEG",school:"Kigali Modern Academy"}]},{id:"STU015",name:"Liam Anderson",level:"P-Level",scores:[{course:"Chemistry",marks:92},{course:"Mathematics",marks:90}],preference:["SCH009","SCH010"],registrationNumber:"REG1015",totalMarks:420,selectedCombinations:null},{id:"STU016",name:"Sophia Martinez",level:"O-Level",scores:[{course:"Physics",marks:88},{course:"Computer Science",marks:85}],preference:["SCH006","SCH008"],registrationNumber:"REG1016",totalMarks:410,selectedCombinations:[{combinationName:"MPC",school:"Rwanda Science Academy"}]},{id:"STU017",name:"Oliver Thomas",level:"P-Level",scores:[{course:"English",marks:80},{course:"Geography",marks:78}],preference:["SCH007","SCH009"],registrationNumber:"REG1017",totalMarks:370,selectedCombinations:null},{id:"STU018",name:"Emma Wilson",level:"O-Level",scores:[{course:"Mathematics",marks:89},{course:"Chemistry",marks:84}],preference:["SCH008","SCH010"],registrationNumber:"REG1018",totalMarks:405,selectedCombinations:[{combinationName:"MCB",school:"Rwanda Science Academy"}]},{id:"STU019",name:"Daniel Garcia",level:"P-Level",scores:[{course:"History",marks:76},{course:"Kinyarwanda",marks:79}],preference:["SCH006","SCH007"],registrationNumber:"REG1019",totalMarks:360,selectedCombinations:null},{id:"STU020",name:"Isabella Robinson",level:"O-Level",scores:[{course:"Physics",marks:91},{course:"Biology",marks:87}],preference:["SCH009","SCH010"],registrationNumber:"REG1020",totalMarks:420,selectedCombinations:[{combinationName:"PCB",school:"Kigali Modern Academy"}]}],Ts=[{id:"SCH006",name:"Rwanda International School",status:"excellent",level:"O-Level",owner:"Private",capacity:450,availableSlots:90,otherSchoolDetails:{}},{id:"SCH007",name:"Kigali Modern Academy",status:"good",level:"O-Level",owner:"Government",capacity:320,availableSlots:120,otherSchoolDetails:{}},{id:"SCH008",name:"Rwanda Science Academy",status:"excellent",level:"A-Level",combinations:["PCM","PCB","MCB","MPC"],owner:"Government",capacity:280,availableSlots:{PCM:{totalSlots:50,remainingSlots:15},PCB:{totalSlots:45,remainingSlots:20},MCB:{totalSlots:40,remainingSlots:10},MPC:{totalSlots:35,remainingSlots:12}},otherSchoolDetails:{}},{id:"SCH009",name:"National Science School",status:"excellent",level:"A-Level",combinations:["PCB","MCB"],owner:"Government",capacity:300,availableSlots:80,otherSchoolDetails:{}},{id:"SCH010",name:"Elite Learning Academy",status:"good",level:"O-Level",owner:"Private",capacity:350,availableSlots:90,otherSchoolDetails:{}}],Is=()=>{const[t,s]=r.useState([]),[a,o]=r.useState(Ps),[n,i]=r.useState(Ts),[l,u]=r.useState(!1),[b,v]=r.useState(!1),[k,g]=r.useState(new Date().getFullYear().toString()),[p,S]=r.useState("secondary"),R=async(d,w)=>{const f=`
Distribute the student to the appropriate school based on the following details:

- Name: ${d.name}
- Registration: ${d.registrationNumber}
- Marks: ${JSON.stringify(d.score||0)}
- Preferred Combinations: ${JSON.stringify(d.selectedCombinations||[])}
- Level: ${d.level}
- Total marks: ${d.totalMarks}

School Info: ${JSON.stringify(w)}

Instructions:
- if ${d.level==="primary"} distribute students to O-Level without combination just according to the high marks and excellent school. do not consider more on course while distributing
  high total marks do not provide to him combination. only secondary students are allowed to have combination
- If the student is at the primary level, assign them to a secondary school based on their total marks.
- If the student has marks less than 50, assign them to a Daily school.
- Secondary students should be assigned to schools based on their selected combinations and total marks.
- Prioritize assignment to Excellent schools when possible.
- If a secondary student's preferred combination is not available, assign them to a school with a matching subject or the best available option.
- Secondary students should sent to A'Level school if the total marks is less than 30 assigned school should be to stay
- Reason should clear explain pointer as talking to the student

Return JSON:
{
  "studentName": "${d.name}",
  "registration": "${d.registrationNumber}",
  "totalMarks": ${d.totalMarks},
  "allocatedSchool": "School A",
  "level": "${d.level}",
  "allocatedCombinations": [{"combinationName": "PCM", "school": "School A"}],
  "reason": "Assigned to Excellent school based on high total marks; preferred combination available."
}
`;try{const x=(await ie.post("https://api.cohere.ai/generate",{model:"command-r-plus-04-2024",prompt:f,max_tokens:300,temperature:1},{headers:{Authorization:"Bearer undefined"}})).data.text.match(/\{[\s\S]*\}/);if(x)return JSON.parse(x[0]);throw new Error("Invalid response structure")}catch(N){return console.error("Error distributing student:",N),{studentName:d.name,registration:d.registrationNumber,totalMarks:d.totalMarks,allocatedSchool:"Error in distribution",level:d.level,allocatedCombinations:[],reason:"An error occurred during distribution"}}},m=async(d,w)=>{if(!(l||a.length===0)){u(!0);try{const f=a.filter(L=>L.level===w);if(f.length===0){C.error(`No students found for ${w} level`),u(!1);return}const N=f.map(L=>R(L,n)),x=await Promise.all(N),I=f.map((L,J)=>({...L,assignedSchool:x[J].allocatedSchool,allocatedCombinations:x[J].allocatedCombinations||[],explanation:x[J].reason}));s(I),g(d),S(w),C.success("Students distributed successfully")}catch(f){console.error("Error distributing students:",f),C.error("Failed to distribute students")}finally{u(!1)}}},h=(d,w)=>{if(a.length===0){C.error("No students available to distribute");return}m(d,w)},y=async(d,w)=>{if(t.length===0){C.error("No distributed students to save");return}v(!0);try{const f={year:d,level:w,distributions:t.map(x=>({name:x.name,registrationNumber:x.registrationNumber,assignedSchool:x.assignedSchool,allocatedCombinations:x.allocatedCombinations,explanation:x.explanation,totalMarks:x.totalMarks}))},N=await ie.post("http://bkyz2-fmaaa-aaaaa-qaaaq-cai.raw.localhost:8000/distribution",f);if(N.data.success)C.success("Distribution saved successfully");else throw new Error(N.data.message||"Failed to save distribution")}catch(f){console.error("Error saving distribution:",f),C.error(f instanceof Error?f.message:"Failed to save distribution")}finally{v(!1)}},j=(d,w,f)=>{if(!d||d.length===0){C.error("No data found in imported file");return}try{const N=d.map((x,I)=>({id:I+1,name:x.name||x.Name||"",registrationNumber:x.registrationNumber||x.Registration||"",score:Number(x.score||x.Score||0),selectedCombinations:x.selectedCombinations||[],level:f,totalMarks:Number(x.totalMarks||x.TotalMarks||0)}));o(N),g(w),S(f),C.success(`Imported ${N.length} students for ${w} - ${f}`)}catch(N){console.error("Error processing imported data:",N),C.error("Failed to process imported data")}},P=()=>{o(a),i(n),C.success("Test data loaded")};return e.jsx(Ds,{title:"Student Distribution",onDistribute:h,onSave:y,onImport:j,onUseTestData:P,isDistributing:l,isSaving:b,distributedStudents:t})},As=()=>{const[t,s]=r.useState(""),[a,o]=r.useState(!1),[n,i]=r.useState([]),l=()=>{t&&setTimeout(()=>{const u=[{id:1,name:"John Doe",location:"Kigali",school:"GS Kigali",status:"Active"},{id:2,name:"Jane Smith",location:"Musanze",school:"GS Musanze",status:"Active"}].filter(b=>b.name.toLowerCase().includes(t.toLowerCase())||b.location.toLowerCase().includes(t.toLowerCase()));i(u),o(!0)},500)};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx(E,{variant:"title",className:"mb-4",children:"Locate Students"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t,onChange:u=>s(u.target.value),placeholder:"Search by name or location...",className:"flex-1 p-2 border rounded-md"}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark",children:"Search"})]})}),a&&e.jsxs("div",{children:[e.jsxs(E,{variant:"subtitle",className:"mb-2",children:["Search Results (",n.length,")"]}),n.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No students found matching your search."}):e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"School"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(u=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.location}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.school}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:u.status})})]},u.id))})]})]})]})},Fs=[{path:"/",element:Gt,protected:!1,children:[{path:"",element:fs,protected:!1}]},{path:"/portal",element:rs,protected:!1,children:[{path:"distributed",element:Is,protected:!1},{path:"locate",element:As,protected:!1}]}],Es=["/","/login"],le=({children:t})=>{const{isAuthenticated:s,loading:a}=se(),o=me();return a?e.jsx("div",{children:"Loading..."}):s&&Es.includes(o.pathname)?e.jsx(ue,{to:"/portal",replace:!0}):e.jsx(e.Fragment,{children:t})},ce=({children:t,path:s})=>{const{isAuthenticated:a,userData:o,loading:n}=se(),i=me();return n?e.jsx(Qe,{}):a?s==="/portal"&&i.pathname==="/portal"?e.jsx(e.Fragment,{children:t}):e.jsx(e.Fragment,{children:t}):e.jsx(ue,{to:"/",state:{from:i},replace:!0})},Ms=()=>e.jsx(ct,{children:e.jsx(ts,{children:e.jsxs("main",{className:"overflow-x-hidden",children:[e.jsx(dt,{children:Fs.map((t,s)=>e.jsx(oe,{path:t.path,element:t.protected?e.jsx(ce,{path:t.path,children:e.jsx(t.element,{})}):e.jsx(le,{children:e.jsx(t.element,{})}),children:t.children&&t.children.map((a,o)=>e.jsx(oe,{path:a.path,element:a.protected?e.jsx(ce,{path:a.path,children:e.jsx(a.element,{})}):e.jsx(le,{children:e.jsx(a.element,{})})},o))},s))}),e.jsx($t,{})]})})});nt(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(Ms,{})}));
